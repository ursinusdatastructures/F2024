<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<!-- Header !-->
	<head>
		<title>Ursinus CS 271: Data Structures And Algorithms, Fall 2024</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<!--[if lte IE 8]><script src="../../assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="../../assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="../../assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="../../assets/css/ie8.css" /><![endif]-->
        <style>
        .image_off, #home:hover .image_on{
           display:none
        }
        .image_on, #home:hover .image_off{
           display:block
        }
        </style>
	</head>
	<body>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="../../index.html" class="logo"><strong>Ursinus CS 271: Data Structures And Algorithms, Fall 2024</strong></a>
								</header>
<!-- End Header !-->

							<!-- Content -->
								<section>
									<header class="main">
										<h2>Lab 6: AVL Trees</h2>
										<h3><a href = "http://www.ctralie.com">Chris Tralie</a></h3>
									</header>

									<div id="page-content">
									

                                        <h2>Overview / Logistics</h2>
										<p>
											We've seen that in a naive implementation of binary trees, we can get very long branches that devolve to linked lists.  This will happen, for example, if we add a bunch of numbers in sorted order.  But we've also seen in class that it's possible to rebalance trees using <b>Tree rotations</b>, while preserving the order of the nodes in an inorder traversal.  In this lab, we will explore a "self-balancing" data structure known as an <b>AVL tree</b> which performs tree rotations on the fly in <b>O(logN)</b> time to keep the tree balanced; that is, the tree will always have a height within a constant factor of <b>log(N)</b> after an add/delete operation, which means that it will only take <b>O(log(N))</b> time to do future searches.  The animation below shows a working implementation of an AVL tree.
										</p>

										<img src = "Example.gif" width="100%">

										<p>
											<a href = "https://github.com/ursinus-cs271-f2023/Lab7_AVL/archive/refs/heads/main.zip">Click here</a> to download the starter notebook for this lab.  If you are using Google colab, the notebook is hosted at <a href = "https://github.com/ursinus-cs271-f2023/Lab7_AVL">https://github.com/ursinus-cs271-f2023/Lab7_AVL</a>.  Either way, you will need to use jupyter to create the tree plots to check your work.
										</p>

										<p>
											<b>Your task:</b> Update the <code>add</code> method to rebalance the tree to an AVL tree if it becomes unbalanced.  The <code>remove</code> method is very similar, so we'll just focus on <code>add</code> in this lab.
										</p>

										<p>
											Be sure that your <code>add</code> method runs in <b>O(log(N))</b> time!  As part of this, you should be careful to <b>update your heights in constant time</b>.
										</p>

										<p>
											When you are finished, upload your <code>Trees.ipynb</code> notebook to canvas.
										</p>

										<HR>

										<h2>Background</h2>
											<p>
												Recall that the two possible <b>tree rotations</b> are defined as follows:
											</p>

											<img src = "Rotate.svg" width="100%">

											<p>
												Note how since the roots change, we return the new root so that we can recursively re-assign children just like we did when removing nodes in the <a href = "../Lab6_TreeRemoval/">last lab</a>.
											</p>

											<p>
												An <b>AVL Tree</b> is a tree that, at every node, has a height discrepancy of at most 1 between the left subtree and the right subtree.  If a child is null, we assume that its height is <b>-1</b>, and this definition carries through.
											</p>

											<p>
												If we start with an AVL tree and add a new node to it, it may become unbalanced.  The following pseudocode below shows how to rebalance an AVL tree along the path from where the node was added back up to the root
											</p>

											<script type="syntaxhighlighter" class="brush: py"><![CDATA[
												add(node)
													root = node

													recursively add as normal, but change to do re-assignments of children (e.g. self.left = self.left.add(key))

													update_height(root)

													if h(right) = h(left) - 2
														if h(left.right) > h(left.left)
															left = rotate_ccw(left)
														root = rotate_cw(node)

													else if h(left) = h(right) - 2
														if h(right.right) < h(right.left)
															right = rotate_cw(right)
														root = rotate_ccw(node)

													return root
												]]></script>

											<p>
												Below are a few examples of this algorithm in action
											</p>

											<HR>
											<h3>Example 1</h3>

											<p>
												Let's suppose we started with this tree
											</p>

											<img src = "Example1/1.svg">

											<p>
												And we then added a <b>11</b> to it, yielding this tree initially
											</p>

											<img src = "Example1/2.svg">

											<p>
												(Note that we haven't updated the height of the parent of 13 yet, so it is not correct).  At this point, we find an imbalance at 13.  By the algorithm above, we rotate clockwise about 13, and we reach a balanced tree
											</p>

											<img src = "Example1/3.svg">

											<HR>
											<h3>
												Example 2
											</h3>

											<p>
												Let's suppose we started with this tree
											</p>

											<img src = "Example2/1.svg">

											<p>
												And we then added a <b>4</b> to it, yielding this tree initially
											</p>

											<img src = "Example2/2.svg">

											<p>
												When we go back up to node 3, we will find it's unbalanced to the right.  We actually have to do two rotations to rebalance node 3.  First, we do clockwise rotation about node 6
											</p>

											<img src = "Example2/3.svg">

											<p>
												Then we do a counter-clockwise rotation about node 3
											</p>

											<img src = "Example2/4.svg">

											<p>
												At this point, we see no further discrepancies on the way back to the root, so the tree is AVL
											</p>

											<HR>
											<h3>
												Example 3
											</h3>

											<p>
												Let's do one more example that shows the power of this algorithm as we recursively walk up the tree.  Let's suppose we start with the following tree:
											</p>

											<img src = "Example3/1.svg">

											<p>
												And let's suppose we add a 12 to it.  As we walk back up recursively to node 13, we change a few of the heights:
											</p>

											<img src = "Example3/2.svg">

											<p>
												Actually, it doesn't seem like we've violated the AVL property yet!  Let's walk up one more and update the height of node 16.
											</p>

											<img src = "Example3/3.svg">

											<p>
												We're still good with the AVL property here!  However, if we walk up one more node to the root at 10, we see there's a problem.  The left subtree has a height of 1, while the right subtree has a height of 3.  This triggers two rotations.  First, we do a clockwise rotation about node 16 since we find 16's right subtree height is less than 16's left subtree height:
											</p>

											<img src = "Example3/4.svg">

											<p>
												From here, we do a counter-clockwise rotation about 10 to yield a tree which is finally AVL:
											</p>

											<img src = "Example3/5.svg">

										

                                    </div>
						</div>
					</div>

					<!--LaTeX in Javascript!-->
					<script src="../../../../../jsMath/easy/load.js"></script>
					<!--Syntax highlighting in Javascript!-->
					<script type="text/javascript" src="../../../../../syntaxhighlighter/scripts/shCore.js"></script>
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushJScript.js"></script>
					<script type="text/javascript" src="../../../../../syntaxhighlighter/scripts/shBrushCpp.js"></script>
					<script type="text/javascript" src="../../../../../syntaxhighlighter/scripts/shBrushMatlabSimple.js"></script>
					<script type="text/javascript" src="../../../../../syntaxhighlighter/scripts/shBrushPython.js"></script>
					<link type="text/css" rel="stylesheet" href="../../../../../syntaxhighlighter/styles/shCoreDefault.css"/>
					<script type="text/javascript">SyntaxHighlighter.all();</script>

<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">
							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
                                        <li>
											<span class="opener">General</span>
											<ul> 
												<li><a href = "../../index.html#overview">Overview</a></li>
												<li><a href = "../../index.html#logistics">Technology Logistics</a></li>
												<li><a href = "../../index.html#deliverables">Deliverables</a>
												<ul>
													<li><a href = "../../index.html#debugging">Debugging Principles</a>
												</ul>
												
												</li>
												<li><a href = "../../index.html#grading">Grading</a></li>
												<li><a href = "../../index.html#environment">Classroom Environment</a></li>
												<li><a href = "../../index.html#participation">Participation</a></li>
												<li><a href = "../../index.html#collaboration">Collaboration Policy</a></li>
												<li><a href = "../../index.html#other">Other Resources / Policies</a></li>
											</ul>
										</li>
										<li><a href = "../../Software/index.html">Software</a> <a href = "https://www.online-python.com/">Online-Python</a><a href = "https://colab.research.google.com/">Google Colab</a></li>
										<li><a href = "../../index.html#schedule">Schedule</a></li>
                                        <li>
											<span class="opener">Assignments</span>
											<ul>
												<li><a href = "../../Assignments/HW1_HashTable/index.html">Assignment 1: Hash Maps And Tweets</a></li>
												<li><a href = "../../Assignments/HW2_PlantCellSegmentation/index.html">Assignment 2: Plant Cell Segmentation</a></li>
												<li><a href = "../../Assignments/HW3_SeamCarving/index.html">Assignment 3: Seam Carving</a>
												<!--<ul>
													<li>
														<a href = "../../Assignments/HW3_SeamCarving/ArtContest/index.html">Art Contest</a>
													</li>
												</ul>!-->
												</li>
												<li><a href = "../../Assignments/HW4_FairElections/index.html">Assignment 4: Fair Elections of Pop Stars</a></li>
												<li><a href = "../../Assignments/HW5_PhylogeneticTrees/index.html">Assignment 5: Phyolgenetic Trees</a></li>
												<li><a href = "../../Assignments/HW6_TSPArt/index.html">Assignment 6: Traveling Salesperson Art</a>

													<!--<ul>
														<li>
															<a href = "../../Assignments/HW6_TSPArt/ArtContest/index.html">Art Contest</a>
														</li>
													</ul>!-->
												</li>
											</ul>
										</li>
										<li>
											<span class="opener">Labs</span>
											<ul>
												<li><a href = "../../Labs/Lab1_LinkedLists/index.html">Lab 1: Linked Lists</a></li>
												<li><a href = "../../Labs/Lab2_UnionFind/index.html">Lab 2: Union Find</a></li>
												<li><a href = "../../Labs/Lab3_Towers/index.html">Lab 3: Towers of Hanoi</a></li>
												<li><a href = "../../Labs/Lab4_MergeSort/index.html">Lab 4: Merge Sort And Kendall-Tau Comprehension</a></li>
												<li><a href = "../../Labs/Lab5_TreeRemoval/index.html">Lab 5: Tree Node Removal</a></li>
												<li><a href = "../../Labs/Lab6_AVL/index.html">Lab 6: AVL Trees</a></li>
												<li><a href = "../../Labs/Lab7_Dijkstra/index.html">Lab 7: Dijkstra's Algorithm</a></li>
											</ul>
										</li>
                                        <li>
											<span class="opener">Notes / Exercises</span>
											<ul>
												<li>
													<a href = "../../../Modules/Module1/Video1">Week 1: Python Self Study Modules</a>
												</li>
												<li><a href = "../../ClassExercises/Week1_Exponents">Week 1: Intro To Exponents / Exponential Time Algorithms</a></li>
												<li><a href = "../../ClassExercises/Week1_Loops">Week 1: Loops in Python</a></li>
												<li><a href = "../../ClassExercises/Week1_CSLog">Week 1: A CS Definition of The Log Function</a></li>
												<li><a href = "../../ClassExercises/Week1_BinarySearch">Week 1: Binary Search</a></li>
												<li><a href = "../../ClassExercises/Week2_Sorting">Week 2: Black Box Sorting in Python</a></li>
												<li><a href = "../../../Modules/ADTModule/Video1">Week 2: ADT Module</a></li>
												<li><a href = "../../ClassExercises/Week2_LinkedList">Week 2: Doubly Linked Lists</a></li>
												<li><a href = "../../ClassExercises/Week2_Needle">Week 2: Needle in A Haystack / Intro To Hashing</a></li>
												<li><a href = "../../ClassExercises/AlgorithmsDemos/Hashing/Hashing.html">Week 2: Harry Potter Hashing</a></li>
												<!--<li><a href = "../../../Modules/StackModule/Video">Week 4: Stacks And Queues Module</a></li>-->
												<li><a href = "../../ClassExercises/Week3_DiscoveringUnionFind">Week 3: Discovering Disjoint Set Data Structures</a></li>
												<li><a href = "../../../Modules/UnionFindModule/Video1">Week 3: Disjoint Sets / Union Find Pre-Lab Module</a></li>
												<li><a href = "../../../Modules/BigO/Video1">Week 3: Informal Introduction To Big-O Notation</a></li>
												<li><a href = "../../ClassExercises/Week3_Asymptotics">Week 3/4: Asymptotics</a></li>
												<li><a href = "https://github.com/ursinus-cs271-f2023/CoursePage/blob/main/ClassExercises/Week4_ComplexityHierarchy/ComplexityHierarchy.ipynb">Exploring complexity hierarchies in matplotlib</a></li>
												<li><a href = "../../../Modules/RecursionModule/Video2">Week 4: Recursion Module</a></li>
												<li><a href = "../../../Modules/EditDistanceModule/Video1">Week 4: Edit Distance Module</a></li>
												<li><a href = "../../ClassExercises/Week5_EditBacktracing">Week 5: Edit Distance Backtracing</a></li>
												<li><a href = "../../../Modules/LCSModule/Video1">Week 5: Longest Common Subsequence Module</a></li>
												<li><a href = "../../../Modules/BasicSortingModule/Video1">Week 6: Sorting Basics Module</a></li>
												<li><a href = "../../ClassExercises/Week7_KendallTau">Week 7: The Kendall Tau Distance between Two Rankings</a></li>
												<li><a href = "../../ClassExercises/Week8_RadixSort">Week 8: Counting Sort + Radix Sort</a></li>
												<li><a href = "../../../Modules/TreesModule/Video1">Week 9: Trees Module</a></li>
												<li><a href = "https://ursinus-cs371-s2022.github.io/Modules/KruskalNotes/Video1">Week 9: Minimum Spanning Trees And Kruskal's Algorithm</a></li>
												<li><a href = "../../ClassExercises/Week9_Phylogenetic">Week 9: Phyolgenetic Trees, Needleman-Wunsch, And Single-Linkage Clustering</a></li>
												<li>
													<a href = "../../../Modules/TreeRotations/Video">Week 10: Tree Rotations Exercise</a>
												</li>
												<li>
													<a href = "../../../Modules/Graphs/Video1">Week 12: Introduction To Graph Data Structures Module</a>
												</li>
												<li>
													<a href = "../../../Modules/BFSDFSTSP/Video1">Week 13: BFS/DFS And Traveling Salesperson Module</a>
												</li>
												<!--
												<li><a href = "https://ursinus-cs371-s2022.github.io/Modules/MakingChange/Video0">Week 6: Backtracing / Making Change</a></li>
												<li><a href = "../../ClassExercises/Week7_GreedyDTW">Week 7: Greedy Time Warping Pitfalls</a></li>
												
												
												
												<li><a href = "https://ursinus-cs371-s2022.github.io/Modules/RadixFisherYates/Video1">Week 9: Radix Sort / Fisher Yates Module</a></li>
												<li><a href = "https://ursinus-cs371-s2022.github.io/Modules/TreesModule/Video1">Week 10: Binary Trees Module</a></li>
												
												<li>
													<a href = "https://ursinus-cs371-s2022.github.io/Modules/HuffmanTrees/Video1">Week 12/13: Huffman Trees Module</a>
												</li>
												-->
											</ul>
										</li>
								<li>
									<span class="opener">Final Assessment</span>
									<ul>
										<li><a href = "../../final.html#codinginterview">Mock Coding Interview</a></li>
										<li><a href = "../../final.html#multimediaexpo">Geometric Algorithm Multimedia Expo</a></li>
									</ul>
								</li>
								</ul>
								</nav>
								


							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">&copy; <a href = "http://www.ctralie.com">Christopher J. Tralie</a>. All rights reserved.  Contact chris.tralie@gmail.com. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
								</footer>

						</div>
					</div>

			</div>
			
            <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
            <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- End Sidebar !-->

<!-- Scripts -->
			<script src="../../assets/js/jquery.min.js"></script>
			<script src="../../assets/js/skel.min.js"></script>
			<script src="../../assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="../../assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="../../assets/js/main.js"></script>
<!-- End Scripts -->
	</body>
</html>
